//----------------------------------------------------------------------------------------------------------------------
// File: SecureBuffer.hpp
// Description: 
//----------------------------------------------------------------------------------------------------------------------
#pragma once
//----------------------------------------------------------------------------------------------------------------------
#include "SecurityTypes.hpp"
//----------------------------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------------------------
namespace Security {
//----------------------------------------------------------------------------------------------------------------------

class SecureBuffer;

//----------------------------------------------------------------------------------------------------------------------
} // Security namespace
//----------------------------------------------------------------------------------------------------------------------

class Security::SecureBuffer
{
public:
    SecureBuffer(Security::Buffer&& buffer);
    ~SecureBuffer();
    
    [[nodiscard]] Security::ReadableView GetData() const;
    [[nodiscard]] Security::ReadableView GetCordon(std::size_t offset, std::size_t size) const;
    [[nodiscard]] std::size_t GetSize() const;
    
private:
    Security::Buffer m_buffer;
};

//----------------------------------------------------------------------------------------------------------------------
